---
// src/pages/[theme].astro
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.astro';
import Services from '../components/Services.astro';
import Pricing from '../components/Pricing.astro';
import About from '../components/About.astro';
import Gallery from '../components/Gallery.astro';
import FAQ from '../components/Faq.astro';
import Contact from '../components/Contact.astro';
import Footer from '../components/Footer.astro';
import ThemeSwitcher from '../components/ThemeSwitcher.astro';

import { BUSINESS_CONFIG, type Theme, IS_DEMO_MODE } from '../information/config';

if (!IS_DEMO_MODE) {
  return Astro.redirect('/');
}

// 1. Kerrotaan Astrolle, mitkä demosivut haluamme rakentaa
export function getStaticPaths() {
  return [
    { params: { theme: 'remontti' } },
    { params: { theme: 'kahvila' } },
    { params: { theme: 'siivous' } },
  ];
}

// 2. Napataan teema suoraan osoitteesta (esim. url /kahvila -> theme = 'kahvila')
// TÄMÄ ON DEMON TAIKA: Emme käytä ACTIVE_THEME -muuttujaa tässä!
const { theme } = Astro.params;
const SITE_THEME = theme as Theme;

// 3. Haetaan data configista
const biz = BUSINESS_CONFIG[SITE_THEME];
const companyFull = `${biz.name} ${biz.legalName}`.trim();

// 4. Määritellään navigaatio
const navLinks = [
  { name: 'Etusivu', href: '#' },
  { name: 'Palvelut', href: '#services' },
  { name: SITE_THEME === 'kahvila' ? 'Menu' : 'Hinnasto', href: '#pricing' },
  { name: SITE_THEME === 'kahvila' ? 'Tarina' : 'Meistä', href: '#about' },
  { name: SITE_THEME === 'remontti' ? 'Referenssit' : SITE_THEME === 'siivous' ? 'Työn jälki' : 'Galleria', href: '#gallery' },
  { name: SITE_THEME === 'kahvila' ? 'Löydä meidät' : 'Ota yhteyttä', href: '#contact' }
];

const heroTitle = SITE_THEME === 'kahvila' ? 'Tuoretta kahvia & tunnelmaa' : undefined;
---

<Layout title={`${companyFull} - Demo`} navLinks={navLinks} preset={SITE_THEME}>
  <main>
    <Hero preset={SITE_THEME} title={heroTitle} />
    <Services preset={SITE_THEME} />
    <Pricing preset={SITE_THEME} />
    <About preset={SITE_THEME} />
    <Gallery preset={SITE_THEME} />
    <FAQ preset={SITE_THEME} />
    <Contact preset={SITE_THEME} />
  </main>

  <Footer preset={SITE_THEME} companyName={companyFull} />
  
  <ThemeSwitcher />
</Layout>