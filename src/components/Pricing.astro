---
// Pricing.astro - Sisältö configista, tyylit dynaamisia
import { CONTENT } from '../information/config';

interface Props {
  preset?:       'default' | 'remontti' | 'kahvila' | 'siivous';
  showSection?: boolean;
  title?:       string;
  subtitle?:    string;
}

const { preset = 'default', showSection = true, title, subtitle } = Astro.props as Props;
if (!showSection) return;

// HAETAAN DATAT
const data = CONTENT[preset].pricing;

// Ylikirjoitetaan, jos manuaalisia propseja on annettu
const heading = title ?? data.title;
const subhead = subtitle ?? data.subtitle;

// SVG ikonit (UI-elementtejä, joten pidetään täällä)
const CHECK = `<path d="M20 6 9 17l-5-5"/>`;
const CROSS = `<path d="M18 6 6 18"/><path d="m6 6 12 12"/>`;
const STAR  = `<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>`;
---

<section id="pricing" class="pricing-section relative overflow-hidden bg-gray-50 py-24 sm:py-32">
  
  <div class="pointer-events-none absolute inset-0 -z-10" aria-hidden="true">
    <div class="absolute inset-0 pricing-dots opacity-40"></div>
    <div
      class="absolute left-1/2 top-0 h-100 w-200 -translate-x-1/2 -translate-y-1/2 rounded-full opacity-[0.07]"
      style="background: radial-gradient(ellipse, var(--brand-color) 0%, transparent 70%);"
    ></div>
  </div>

  <div class="mx-auto max-w-7xl px-6 lg:px-8">
    <div class="pricing-header mx-auto mb-16 max-w-2xl text-center">
      <span class="inline-block mb-5 rounded-full px-4 py-1.5 text-xs font-bold uppercase tracking-widest bg-brand/10 text-brand font-heading">
        {data.eyebrow}
      </span>
      <h2 class="mb-5 font-extrabold text-gray-900 font-heading" style="font-size:clamp(1.875rem,4vw,3rem);">
        {heading}
      </h2>
      <p class="text-lg text-gray-500 font-body">{subhead}</p>
    </div>

    <div class="grid grid-cols-1 gap-8 md:grid-cols-3">
      {data.cards.map((card) => (
        <div 
          class={`pricing-card relative flex flex-col rounded-(--radius-box) bg-white p-8 transition-all duration-300 ${card.popular ? 'ring-2 ring-brand shadow-2xl scale-[1.03] z-10' : 'ring-1 ring-gray-200 shadow-md hover:shadow-xl'}`}
        >
          
          {card.popular && (
            <div class="absolute -top-4 left-1/2 -translate-x-1/2 z-20">
              <span class="inline-flex items-center gap-1.5 rounded-full px-4 py-1.5 text-xs font-bold bg-brand text-white shadow-lg font-heading">
                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="currentColor" set:html={STAR}/>
                SUOSITUIN
              </span>
            </div>
          )}

          <div class="mb-6">
            <h3 class="text-xl font-extrabold text-gray-900 font-heading">{card.name}</h3>
            <p class="text-sm text-gray-500 font-body">{card.description}</p>
          </div>

          <div class="mb-8 border-b border-gray-100 pb-8">
            <span class="text-3xl font-black text-gray-900 font-heading">{card.price}</span>
            {card.priceNote && <p class="text-xs text-gray-400 font-body">{card.priceNote}</p>}
          </div>

          <ul class="mb-8 flex-1 space-y-3">
            {card.features.map(({ text, included }) => (
              <li class="flex items-start gap-3">
                <span class={`mt-0.5 flex h-5 w-5 shrink-0 items-center justify-center rounded-full ${included ? 'bg-brand/10' : 'bg-gray-100'}`}>
                  <svg xmlns="http://www.w3.org/2000/svg" width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" class={included ? 'text-brand' : 'text-gray-300'} set:html={included ? CHECK : CROSS} />
                </span>
                <span class={`text-sm font-body ${included ? 'text-gray-700' : 'text-gray-400 line-through'}`}>{text}</span>
              </li>
            ))}
          </ul>

          <a href={card.ctaHref} class={`inline-flex w-full items-center justify-center gap-2 rounded-(--radius-btn) px-6 py-3.5 text-sm font-bold transition-all font-heading ${card.popular ? 'bg-brand text-white hover:bg-brand-hover shadow-lg' : 'bg-white text-brand ring-1 ring-brand hover:bg-brand hover:text-white'}`}>
            {card.cta}
          </a>
        </div>
      ))}
    </div>

    <div class="mt-16 flex flex-col items-center gap-5 rounded-2xl p-8 bg-brand/5 ring-1 ring-brand/10 sm:flex-row">
      <div class="flex-1">
        <p class="font-bold text-gray-900 font-heading">Tarvitsetko jotain muuta?</p>
        <p class="text-sm text-gray-500 font-body">Ota yhteyttä, niin suunnitellaan juuri teille sopiva kokonaisuus.</p>
      </div>
      <a href="#contact" class="bg-brand text-white px-6 py-3 rounded-(--radius-btn) font-bold shadow-md hover:bg-brand-hover transition-all font-heading">
        Pyydä tarjous
      </a>
    </div>

    {data.note && <p class="mt-10 text-center text-xs text-gray-400 font-body">* {data.note}</p>}
  </div>
</section>

<style>
  .pricing-dots { background-image: radial-gradient(circle, #d1d5db 1px, transparent 1px); background-size: 28px 28px; }
  @keyframes fadeUp { from { opacity: 0; transform: translateY(28px); } to { opacity: 1; transform: translateY(0); } }
  .pricing-header, .pricing-card { animation: fadeUp 0.7s cubic-bezier(0.16,1,0.3,1) both; }
</style>